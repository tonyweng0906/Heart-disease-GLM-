"0","dat$Sex <- as.factor(dat$Sex)"
"0","dat$ChestPainType <- as.factor(dat$ChestPainType)"
"0","dat$RestingECG <- as.factor(dat$RestingECG)"
"0","dat$ExerciseAngina <- as.factor(dat$ExerciseAngina)"
"0","dat$ST_Slope <- as.factor(dat$ST_Slope)"
"0",""
"0","# Full model with all predictors"
"0","full_model <- glm(HeartDisease ~ Age + Sex + ChestPainType + RestingBP + Cholesterol + "
"0","                  FastingBS + RestingECG + MaxHR + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""logit""))"
"0",""
"0","p_values <- summary(full_model)$coefficients[, 4]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: RestingECGNormal | p-value: 0.515021919301189"""
"1","
"
"0","deviance_full<-summary(full_model)$deviance"
"0",""
"0","# Remove RestingECGNormal"
"0",""
"0","model_1<-glm(HeartDisease ~ Age + Sex + ChestPainType + RestingBP + Cholesterol + "
"0","                  FastingBS + MaxHR + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""logit""))"
"0",""
"0","lr_test_1 <- anova(model_1, full_model, test = ""Chisq"")"
"0","cat(""Comparison of model 1 and full model:\n"")"
"1","Comparison of model 1 and full model:
"
"0","cat(""Log-Likelihood Ratio/Deviance Test statistic: "", lr_test_1$Deviance[2], ""\n"")"
"1","Log-Likelihood Ratio/Deviance Test statistic: "
"1"," "
"1","0.6552061"
"1"," "
"1","
"
"0","cat(""p-value: "", lr_test_1$`Pr(>Chi)`[2], ""\n"")"
"1","p-value: "
"1"," "
"1","0.720649"
"1"," "
"1","
"
"0","p_values <- summary(model_1)$coefficients[, 4]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: RestingBP | p-value: 0.504585009221759"""
"1","
"
"0","deviance_1<-summary(model_1)$deviance"
"0",""
"0",""
"0","# Remove RestingBP"
"0",""
"0","model_2<-glm(HeartDisease ~ Age + Sex + ChestPainType + Cholesterol + "
"0","                  FastingBS + MaxHR + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""logit""))"
"0",""
"0","lr_test_2 <- anova(model_2, model_1, test = ""Chisq"")"
"0","cat(""Comparison of model 2 and model 1:\n"")"
"1","Comparison of model 2 and model 1:
"
"0","cat(""Log-Likelihood Ratio/Deviance Test statistic: "", lr_test_2$Deviance[2], ""\n"")"
"1","Log-Likelihood Ratio/Deviance Test statistic: "
"1"," "
"1","0.4436157"
"1"," "
"1","
"
"0","cat(""p-value: "", lr_test_2$`Pr(>Chi)`[2], ""\n"")"
"1","p-value: "
"1"," "
"1","0.5053824"
"1"," "
"1","
"
"0","p_values <- summary(model_2)$coefficients[, 4][-1]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: MaxHR | p-value: 0.468876489199628"""
"1","
"
"0","deviance_2<-summary(model_2)$deviance"
"0",""
"0",""
"0","# Remove MaxHR"
"0",""
"0","model_3<-glm(HeartDisease ~ Age + Sex + ChestPainType + Cholesterol + "
"0","                  FastingBS + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""logit""))"
"0",""
"0","lr_test_3 <- anova(model_3, model_2, test = ""Chisq"")"
"0","cat(""Comparison of model 3 and model 2:\n"")"
"1","Comparison of model 3 and model 2:
"
"0","cat(""Log-Likelihood Ratio/Deviance Test statistic: "", lr_test_3$Deviance[2], ""\n"")"
"1","Log-Likelihood Ratio/Deviance Test statistic: "
"1"," "
"1","0.5244608"
"1"," "
"1","
"
"0","cat(""p-value: "", lr_test_3$`Pr(>Chi)`[2], ""\n"")"
"1","p-value: "
"1"," "
"1","0.468945"
"1"," "
"1","
"
"0","p_values <- summary(model_3)$coefficients[, 4]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: Age | p-value: 0.0517701795228619"""
"1","
"
"0","deviance_3<-summary(model_3)$deviance"
"0",""
"0",""
"0","# Remove Age"
"0",""
"0","model_4<-glm(HeartDisease ~ Sex + ChestPainType + Cholesterol + "
"0","                  FastingBS + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""logit""))"
"0",""
"0","lr_test_4 <- anova(model_4, model_3, test = ""Chisq"")"
"0","cat(""Comparison of model 4 and model 3:\n"")"
"1","Comparison of model 4 and model 3:
"
"0","cat(""Log-Likelihood Ratio/Deviance Test statistic: "", lr_test_4$Deviance[2], ""\n"")"
"1","Log-Likelihood Ratio/Deviance Test statistic: "
"1"," "
"1","3.800442"
"1"," "
"1","
"
"0","cat(""p-value: "", lr_test_4$`Pr(>Chi)`[2], ""\n"")"
"1","p-value: "
"1"," "
"1","0.05123907"
"1"," "
"1","
"
"0","p_values <- summary(model_4)$coefficients[, 4][-1]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: ST_SlopeUp | p-value: 0.0168401873690736"""
"1","
"
"0","deviance_4<-summary(model_4)$deviance"
"0",""
"0","# Try removing ST_Slope"
"0",""
"0","model_5<-glm(HeartDisease ~ Sex + ChestPainType + Cholesterol + "
"0","                  FastingBS + ExerciseAngina + Oldpeak, "
"0","                  data = dat, family = binomial(link = ""logit""))"
"0",""
"0","lr_test_5 <- anova(model_5, model_4, test = ""Chisq"")"
"0","cat(""Comparison of model 5 and model 4:\n"")"
"1","Comparison of model 5 and model 4:
"
"0","cat(""Log-Likelihood Ratio/Deviance Test statistic: "", lr_test_5$Deviance[2], ""\n"")"
"1","Log-Likelihood Ratio/Deviance Test statistic: "
"1"," "
"1","129.7074"
"1"," "
"1","
"
"0","cat(""p-value: "", lr_test_5$`Pr(>Chi)`[2], ""\n"")"
"1","p-value: "
"1"," "
"1","6.829707e-29"
"1"," "
"1","
"
"0","p_values <- summary(model_5)$coefficients[, 4][-1]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: ChestPainTypeTA | p-value: 0.00103235199327098"""
"1","
"
"0","deviance_5<-summary(model_5)$deviance"
"0",""
"0","# Fail to remove ST_Slope, model 4 is best model"
"0","best_logit_model<-model_4"
