"0","dat$Sex <- as.factor(dat$Sex)"
"0","dat$ChestPainType <- as.factor(dat$ChestPainType)"
"0","dat$RestingECG <- as.factor(dat$RestingECG)"
"0","dat$ExerciseAngina <- as.factor(dat$ExerciseAngina)"
"0","dat$ST_Slope <- as.factor(dat$ST_Slope)"
"0",""
"0","# Full model with all predictors"
"0","full_model <- glm(HeartDisease ~ Age + Sex + ChestPainType + RestingBP + Cholesterol + "
"0","                  FastingBS + RestingECG + MaxHR + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""cloglog""))"
"0",""
"0","p_values <- summary(full_model)$coefficients[, 4]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: RestingECGNormal | p-value: 0.594071731776312"""
"1","
"
"0","deviance_full<-summary(full_model)$deviance"
"0",""
"0","# Remove RestingECGNormal"
"0",""
"0","model_1<-glm(HeartDisease ~ Age + Sex + ChestPainType + RestingBP + Cholesterol + "
"0","                  FastingBS + MaxHR + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""cloglog""))"
"0",""
"0","lr_test_1 <- anova(model_1, full_model, test = ""Chisq"")"
"0","cat(""Comparison of model 1 and full model:\n"")"
"1","Comparison of model 1 and full model:
"
"0","cat(""Log-Likelihood Ratio/Deviance Test statistic: "", lr_test_1$Deviance[2], ""\n"")"
"1","Log-Likelihood Ratio/Deviance Test statistic: "
"1"," "
"1","0.9578541"
"1"," "
"1","
"
"0","cat(""p-value: "", lr_test_1$`Pr(>Chi)`[2], ""\n"")"
"1","p-value: "
"1"," "
"1","0.6194477"
"1"," "
"1","
"
"0","p_values <- summary(model_1)$coefficients[, 4]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: Age | p-value: 0.395852568138676"""
"1","
"
"0","deviance_1<-summary(model_1)$deviance"
"0",""
"0",""
"0","# Remove Age"
"0",""
"0","model_2<-glm(HeartDisease ~ Sex + ChestPainType + RestingBP + Cholesterol + "
"0","                  FastingBS + MaxHR + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""cloglog""))"
"0",""
"0","lr_test_2 <- anova(model_2, model_1, test = ""Chisq"")"
"0","cat(""Comparison of model 2 and model 1:\n"")"
"1","Comparison of model 2 and model 1:
"
"0","cat(""Log-Likelihood Ratio/Deviance Test statistic: "", lr_test_2$Deviance[2], ""\n"")"
"1","Log-Likelihood Ratio/Deviance Test statistic: "
"1"," "
"1","0.6856822"
"1"," "
"1","
"
"0","cat(""p-value: "", lr_test_2$`Pr(>Chi)`[2], ""\n"")"
"1","p-value: "
"1"," "
"1","0.4076369"
"1"," "
"1","
"
"0","p_values <- summary(model_2)$coefficients[, 4][-1]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: RestingBP | p-value: 0.202465346420105"""
"1","
"
"0","deviance_2<-summary(model_2)$deviance"
"0",""
"0",""
"0","# Remove RestingBP"
"0",""
"0","model_3<-glm(HeartDisease ~ Sex + ChestPainType + Cholesterol + "
"0","                  FastingBS + MaxHR + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""cloglog""))"
"0",""
"0","lr_test_3 <- anova(model_3, model_2, test = ""Chisq"")"
"0","cat(""Comparison of model 3 and model 2:\n"")"
"1","Comparison of model 3 and model 2:
"
"0","cat(""Log-Likelihood Ratio/Deviance Test statistic: "", lr_test_3$Deviance[2], ""\n"")"
"1","Log-Likelihood Ratio/Deviance Test statistic: "
"1"," "
"1","1.75063"
"1"," "
"1","
"
"0","cat(""p-value: "", lr_test_3$`Pr(>Chi)`[2], ""\n"")"
"1","p-value: "
"1"," "
"1","0.1857976"
"1"," "
"1","
"
"0","p_values <- summary(model_3)$coefficients[, 4][-1]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: MaxHR | p-value: 0.0640717678346812"""
"1","
"
"0","deviance_3<-summary(model_3)$deviance"
"0",""
"0",""
"0","# Remove MaxHR"
"0",""
"0","model_4<-glm(HeartDisease ~ Sex + ChestPainType + Cholesterol + "
"0","                  FastingBS + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""cloglog""))"
"0",""
"0","lr_test_4 <- anova(model_4, model_3, test = ""Chisq"")"
"0","cat(""Comparison of model 4 and model 3:\n"")"
"1","Comparison of model 4 and model 3:
"
"0","cat(""Log-Likelihood Ratio/Deviance Test statistic: "", lr_test_4$Deviance[2], ""\n"")"
"1","Log-Likelihood Ratio/Deviance Test statistic: "
"1"," "
"1","3.40888"
"1"," "
"1","
"
"0","cat(""p-value: "", lr_test_4$`Pr(>Chi)`[2], ""\n"")"
"1","p-value: "
"1"," "
"1","0.06484643"
"1"," "
"1","
"
"0","p_values <- summary(model_4)$coefficients[, 4][-1]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: Oldpeak | p-value: 0.00167453360520785"""
"1","
"
"0","deviance_4<-summary(model_4)$deviance"
"0",""
"0","# Try removing OldPeak"
"0",""
"0","model_5<-glm(HeartDisease ~ Sex + ChestPainType + Cholesterol + "
"0","                  FastingBS + ExerciseAngina + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""cloglog""))"
"0",""
"0","lr_test_5 <- anova(model_5, model_4, test = ""Chisq"")"
"0","cat(""Comparison of model 5 and model 4:\n"")"
"1","Comparison of model 5 and model 4:
"
"0","cat(""Log-Likelihood Ratio/Deviance Test statistic: "", lr_test_5$Deviance[2], ""\n"")"
"1","Log-Likelihood Ratio/Deviance Test statistic: "
"1"," "
"1","9.063929"
"1"," "
"1","
"
"0","cat(""p-value: "", lr_test_5$`Pr(>Chi)`[2], ""\n"")"
"1","p-value: "
"1"," "
"1","0.002607012"
"1"," "
"1","
"
"0","p_values <- summary(model_5)$coefficients[, 4][-1]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: ST_SlopeFlat | p-value: 0.00521615245371466"""
"1","
"
"0","deviance_5<-summary(model_5)$deviance"
"0",""
"0","# Fail to remove OldPeak, best model is model_4"
"0","best_cloglog_model<-model_4"
