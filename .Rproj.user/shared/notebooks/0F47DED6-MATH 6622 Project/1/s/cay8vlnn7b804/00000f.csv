"0","dat$Sex <- as.factor(dat$Sex)"
"0","dat$ChestPainType <- as.factor(dat$ChestPainType)"
"0","dat$RestingECG <- as.factor(dat$RestingECG)"
"0","dat$ExerciseAngina <- as.factor(dat$ExerciseAngina)"
"0","dat$ST_Slope <- as.factor(dat$ST_Slope)"
"0",""
"0","# Full model with all predictors"
"0","full_model <- glm(HeartDisease ~ Age + Sex + ChestPainType + RestingBP + Cholesterol + "
"0","                  FastingBS + RestingECG + MaxHR + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""probit""))"
"0",""
"0","p_values <- summary(full_model)$coefficients[, 4]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: RestingECGNormal | p-value: 0.391899285828253"""
"1","
"
"0","deviance_full<-summary(full_model)$deviance"
"0",""
"0","# Remove RestingECGNormal"
"0",""
"0","model_1<-glm(HeartDisease ~ Age + Sex + ChestPainType + RestingBP + Cholesterol + "
"0","                  FastingBS + MaxHR + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""probit""))"
"0",""
"0","lr_test_1 <- anova(model_1, full_model, test = ""Chisq"")"
"0","cat(""Comparison of model 1 and full model:\n"")"
"1","Comparison of model 1 and full model:
"
"0","cat(""Log-Likelihood Ratio/Deviance Test statistic: "", lr_test_1$Deviance[2], ""\n"")"
"1","Log-Likelihood Ratio/Deviance Test statistic: "
"1"," "
"1","1.193394"
"1"," "
"1","
"
"0","cat(""p-value: "", lr_test_1$`Pr(>Chi)`[2], ""\n"")"
"1","p-value: "
"1"," "
"1","0.5506275"
"1"," "
"1","
"
"0","p_values <- summary(model_1)$coefficients[, 4]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: MaxHR | p-value: 0.47421630950207"""
"1","
"
"0","deviance_1<-summary(model_1)$deviance"
"0",""
"0","# Remove MaxHR"
"0",""
"0","model_2<-glm(HeartDisease ~ Age + Sex + ChestPainType + RestingBP + Cholesterol + "
"0","                  FastingBS + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""probit""))"
"0",""
"0","lr_test_2 <- anova(model_2, model_1, test = ""Chisq"")"
"0","cat(""Comparison of model 2 and model 1:\n"")"
"1","Comparison of model 2 and model 1:
"
"0","cat(""Log-Likelihood Ratio/Deviance Test statistic: "", lr_test_2$Deviance[2], ""\n"")"
"1","Log-Likelihood Ratio/Deviance Test statistic: "
"1"," "
"1","0.5048549"
"1"," "
"1","
"
"0","cat(""p-value: "", lr_test_2$`Pr(>Chi)`[2], ""\n"")"
"1","p-value: "
"1"," "
"1","0.4773746"
"1"," "
"1","
"
"0","p_values <- summary(model_2)$coefficients[, 4]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values[-1])"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: RestingBP | p-value: 0.339536612240353"""
"1","
"
"0","deviance_2<-summary(model_2)$deviance"
"0",""
"0","# Remove RestingBP"
"0",""
"0","model_3<-glm(HeartDisease ~ Age + Sex + ChestPainType + Cholesterol + "
"0","                  FastingBS + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""probit""))"
"0",""
"0","lr_test_3 <- anova(model_3, model_2, test = ""Chisq"")"
"0","cat(""Comparison of model 3 and model 2:\n"")"
"1","Comparison of model 3 and model 2:
"
"0","cat(""Log-Likelihood Ratio/Deviance Test statistic: "", lr_test_3$Deviance[2], ""\n"")"
"1","Log-Likelihood Ratio/Deviance Test statistic: "
"1"," "
"1","0.9420181"
"1"," "
"1","
"
"0","cat(""p-value: "", lr_test_3$`Pr(>Chi)`[2], ""\n"")"
"1","p-value: "
"1"," "
"1","0.3317594"
"1"," "
"1","
"
"0","p_values <- summary(model_3)$coefficients[, 4][-1]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values)"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: Age | p-value: 0.024443164118183"""
"1","
"
"0","deviance_3<-summary(model_3)$deviance"
"0",""
"0","# See if Age can be removed"
"0",""
"0","model_4<-glm(HeartDisease ~ Sex + ChestPainType + Cholesterol + "
"0","                  FastingBS + ExerciseAngina + Oldpeak + ST_Slope, "
"0","                  data = dat, family = binomial(link = ""probit""))"
"0",""
"0","lr_test_4 <- anova(model_4, model_3, test = ""Chisq"")"
"0","cat(""Comparison of model 4 and model 3:\n"")"
"1","Comparison of model 4 and model 3:
"
"0","cat(""Log-Likelihood Ratio/Deviance Test statistic: "", lr_test_4$Deviance[2], ""\n"")"
"1","Log-Likelihood Ratio/Deviance Test statistic: "
"1"," "
"1","5.048791"
"1"," "
"1","
"
"0","cat(""p-value: "", lr_test_4$`Pr(>Chi)`[2], ""\n"")"
"1","p-value: "
"1"," "
"1","0.02464312"
"1"," "
"1","
"
"0","p_values <- summary(model_4)$coefficients[, 4][-1]"
"0","predictor_to_remove <- names(p_values)[which.max(p_values)]"
"0","max_p_value <- max(p_values)"
"0","paste(""Next covariate to remove:"", predictor_to_remove, ""| p-value:"", max_p_value)"
"1","[1]"
"1"," ""Next covariate to remove: ST_SlopeUp | p-value: 0.00811551812054334"""
"1","
"
"0","deviance_4<-summary(model_4)$deviance"
"0",""
"0","# Fail to remove Age, model 3 is best model"
"0","best_probit_model<-model_3"
